/*!***
 * gpaCalc.js - v0.1.0
 * Custom JS script module for functionalizing the Cougar Success website's GPA calculator built in the Gravity Forms.
 * By Daniel C. Rieck (daniel.rieck@wsu.edu). See [GitHub](https://github.com/invokeImmediately/cougarsuccess.wsu.edu/blob/main/JS/gpaCalc.js) for more info.
 * Copyright (c) 2022 Washington State University and governed by the MIT license.
 ****/
!function(t){const s=t.$,e=t.formSel,i=t.sbmtBtnSel,l=t.courseFldsSel,r=t.cumlGpaFldSel,n=t.semGpaCoursesListStr,a=t.semGpaFldSel,o=t.semGpaNoCoursesMsg;class c{constructor(t,e,i,l,n,a,o){this.formSel=t,this.sbmtBtnSel=e,this.courseFldsSel=i,this.semGpaFldSel=l,this.semGpaNoCoursesMsg=n,this.semGpaCoursesListStr=a,this.cumlGpaFldSel=r,this.clMissingInp="gpa-calc-gf__missing-inp",this.gradeLookupTbl={A:4,"A-":3.7,"B+":3.3,B:3,"B-":2.7,"C+":2.3,C:2,"C-":1.7,"D+":1.3,D:1,F:0},this.$form=s(t),1===this.$form.length&&(this.disableSbmtBtn(),this.disableSemGpaField(),this.disableCumGpaField(),this.restrictCurGpaEntry(),this.restrictTotCreditsEntry(),this.restrictGradeEntry(),this.restrictCreditsEntry(),this.restrictRetakeEntry(),this.restrictRetakeGradeEntry(),this.setUpCalculations(),this.addMoreInitialRows())}addMoreInitialRows(){}disableCumGpaField(){}disableSbmtBtn(){this.$sbmtBtn=s(this.sbmtBtnSel),this.$sbmtBtn.on("click",(function(t){t.preventDefault()})),this.$sbmtBtn.on("click",(function(t){t.preventDefault()})),this.$sbmtBtn.attr("tabindex","-1"),this.$sbmtBtn.prop("disabled",!0),this.$sbmtBtn.css("display","none")}disableSemGpaField(){}restrictCurGpaEntry(){}restrictCreditsEntry(){}restrictGradeEntry(){}restrictRetakeEntry(){}restrictRetakeGradeEntry(){}restrictTotCreditsEntry(){}setUpCalculations(){this.$courseFlds=this.$form.find(this.courseFldsSel),this.$cumGpa=this.$form.find(this.cumlGpaFldSel),this.$semGpa=this.$form.find(this.semGpaFldSel);const t=this;this.$form.on("change",this.courseFldsSel+" input",(function(e){const i=s(this);t.checkCourseDetailsRow(e,i)}))}checkCourseDetailsRow(t,s){const e=s.parent().parent();this.chkCourseNameAbs(e),this.recalcGpas(t)}recalcGpas(t){this.recalcSemGpa(t)}recalcSemGpa(t){console.log("Recalculating semester GPA.");let e=0,i=0;const l=this.$courseFlds.find(".gfield_list_group"),r=this,n=[];if(l.each((function(){const t=s(this),l=t.find(".gfield_list_5_cell1 input"),a=t.find(".gfield_list_5_cell2 input"),o=a.val().toString(),c=""!==a.val()?r.gradeLookupTbl[o]:null,d=t.find(".gfield_list_5_cell3 input"),p=parseInt(d.val().toString(),10);null!==c&&p>0&&(e+=c*p,i+=p,n.push(l.val().toString()))})),i>0){const t=this.$semGpa.parents(".gfield").first().find(".gfield_description"),s=n.reduce(((t,s,e)=>0===e?s:t+", "+s),"");this.$semGpa.val((e/i).toFixed(2)),t.html(this.semGpaCoursesListStr+s)}else{this.$semGpa.parents(".gfield").first().find(".gfield_description").html(this.semGpaNoCoursesMsg)}}recalcCumGpa(t){console.log("Recalculating cumulative GPA.")}chkCourseNameAbs(t){const s=t.find(".gfield_list_5_cell1 input"),e=s.val().toString();if(this.rowIsEmpty(t))t.find("input").removeClass(this.clMissingInp);else if(""===e){const t=/Course Name, Row ([0-9]+)/,e=s.attr("aria-label").toString().match(t);s.val(`Course ${e[1]}`)}}markInpAsMissing(t){}rowIsEmpty(t){const e=t.find("input");let i=!0;return e.each((function(){const t=s(this);i&&(i=""===t.val())})),i}}s(document).on("gform_post_render",(function(){new c(e,i,l,a,o,n,r)}))}({$:jQuery,formSel:".gpa-calc-gf",sbmtBtnSel:'.gform_button[type="submit"]',courseFldsSel:".gfield.gpa-calc-gf__course-details",semGpaFldSel:".gfield.gpa-calc-gf__sem-gpa input",semGpaNoCoursesMsg:"Waiting for course details to be entered.",semGpaCoursesListStr:"This GPA is based on the details entered for courses: ",cumlGpaFldSel:".gfield.gpa-calc-gf__cuml-gpa input"});